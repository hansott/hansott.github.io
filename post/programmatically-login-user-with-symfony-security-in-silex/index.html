<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Programmatically login user with symfony/security in Silex</title>
<link href="https://hansott.github.io/index.xml" rel="alternate" type="application/rss+xml" title="Hans Ott" />
<meta name="description" content="I&#39;m a web &amp; mobile developer with a strong interest in domain-driven design and functional programming.">
<meta name="author" content="Hans Ott">
<meta property="og:title" content="Programmatically login user with symfony/security in Silex" />
<meta property="og:description" content="Last night I was experimenting with Silex and I needed a register/login form. Silex comes with a SecurityServiceProvider which gives you the power of the symfony/security component. But I couldn&rsquo;t figure out how to programmatically login the user after registration. So here&rsquo;s my solution:
The registration controller:
&lt;?php use Silex\Application; use Symfony\Component\HttpFoundation\Request; final class RegistrationController { // ... public function register(Request $request, Application $app) { $email = $request-&gt;get(&#39;email&#39;); $password = $request-&gt;get(&#39;password&#39;); // validation logic." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hansott.github.io/post/programmatically-login-user-with-symfony-security-in-silex/" />



<meta property="article:published_time" content="2016-05-02T20:40:00&#43;02:00"/>
<meta property="article:modified_time" content="2016-05-02T20:40:00&#43;02:00"/>













<meta itemprop="name" content="Programmatically login user with symfony/security in Silex">
<meta itemprop="description" content="Last night I was experimenting with Silex and I needed a register/login form. Silex comes with a SecurityServiceProvider which gives you the power of the symfony/security component. But I couldn&rsquo;t figure out how to programmatically login the user after registration. So here&rsquo;s my solution:
The registration controller:
&lt;?php use Silex\Application; use Symfony\Component\HttpFoundation\Request; final class RegistrationController { // ... public function register(Request $request, Application $app) { $email = $request-&gt;get(&#39;email&#39;); $password = $request-&gt;get(&#39;password&#39;); // validation logic.">


<meta itemprop="dateModified" content="2016-05-02T20:40:00&#43;02:00" />
<meta itemprop="wordCount" content="216">



<meta itemprop="keywords" content="Homestead,Laravel,MySql,PHP,PhpStorm,React,Redux,Silex,Symfony,Vagrant," />



  <meta name="twitter:card" content="summary"/>



<meta name="twitter:text:title" content="Programmatically login user with symfony/security in Silex"/>
<meta name="twitter:title" content="Programmatically login user with symfony/security in Silex"/>
<meta name="twitter:description" content="Last night I was experimenting with Silex and I needed a register/login form. Silex comes with a SecurityServiceProvider which gives you the power of the symfony/security component. But I couldn&rsquo;t figure out how to programmatically login the user after registration. So here&rsquo;s my solution:
The registration controller:
&lt;?php use Silex\Application; use Symfony\Component\HttpFoundation\Request; final class RegistrationController { // ... public function register(Request $request, Application $app) { $email = $request-&gt;get(&#39;email&#39;); $password = $request-&gt;get(&#39;password&#39;); // validation logic."/>


<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
<link rel="stylesheet" href="/css/main.css">

    </head>
    <body>
        <header>
    <nav class="nav has-shadow">
        <div class="container">
            <div class="nav-left">
                <a class="nav-item is-logo" href="/">Hans Ott</a>
                <a class="nav-item is-tab is-hidden-mobile " href="/">Blog</a>
                    <a class="nav-item is-tab is-hidden-mobile " href="/about/">
                        About
                    </a>
                
                    <a class="nav-item is-tab is-hidden-mobile " href="/packages/">
                        Packages
                    </a>
                
                    <a class="nav-item is-tab is-hidden-mobile " href="/reading-list/">
                        Reading list
                    </a>
                
            </div>
            <div class="nav-right">
                <a class="nav-item" href="https://github.com/hansott" target="_blank">
                    <span class="icon">
                        <i class="fa fa-github"></i>
                    </span>
                </a>
                <a class="nav-item" href="https://www.linkedin.com/in/otthans" target="_blank">
                    <span class="icon">
                        <i class="fa fa-linkedin"></i>
                    </span>
                </a>
                <a class="nav-item" href="https://stackoverflow.com/users/3455472" target="_blank">
                    <span class="icon">
                        <i class="fa fa-stack-overflow"></i>
                    </span>
                </a>
                <a class="nav-item" href="https://twitter.com/otthans" target="_blank">
                    <span class="icon">
                        <i class="fa fa-twitter"></i>
                    </span>
                </a>
            </div>
            <span class="nav-toggle js-nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </span>
            <div class="nav-right nav-menu is-hidden-tablet js-nav-menu">
                <a class="nav-item is-tab " href="/">Blog</a>
                    <a class="nav-item is-tab " href="/about/">
                        About
                    </a>
                
                    <a class="nav-item is-tab " href="/packages/">
                        Packages
                    </a>
                
                    <a class="nav-item is-tab " href="/reading-list/">
                        Reading list
                    </a>
                
            </div>
        </div>
    </nav>
</header>

        
    <article class="post">
        <div class="hero is-primary is-bold">
            <div class="hero-body">
                <div class="container">
                    <h1 class="title">Programmatically login user with symfony/security in Silex</h1>
                    <h2 class="subtitle">
                        <time datetime="2016-05-02T20:40:00&#43;02:00">
                        May 2, 2016
                        </time> Â· 2 min read
                    </h2>
                    
                        
                            <p>
                                
                                    <a href="/tags/php">
                                        <span class="tag">PHP</span>
                                    </a>
                                
                                    <a href="/tags/silex">
                                        <span class="tag">Silex</span>
                                    </a>
                                
                                    <a href="/tags/symfony">
                                        <span class="tag">Symfony</span>
                                    </a>
                                
                            </p>
                        
                    
                </div>
            </div>
        </div>

        <div class="container">
            <div class="main">
                
        <div class="content">
            <p>Last night I was experimenting with Silex and I needed a register/login form. Silex comes with a <code>SecurityServiceProvider</code> which gives you the power of the symfony/security component. But I couldn&rsquo;t figure out how to programmatically login the user after registration. So here&rsquo;s my solution:</p>

<p>The registration controller:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #633820">&lt;?php</span>

<span style="color: #A90D91">use</span> <span style="color: #000000">Silex\Application</span>;
<span style="color: #A90D91">use</span> <span style="color: #000000">Symfony\Component\HttpFoundation\Request</span>;

<span style="color: #A90D91">final</span> <span style="color: #A90D91">class</span> <span style="color: #3F6E75">RegistrationController</span>
{
    <span style="color: #177500">// ...</span>

    <span style="color: #A90D91">public</span> <span style="color: #A90D91">function</span> <span style="color: #000000">register</span>(<span style="color: #000000">Request</span> <span style="color: #000000">$request</span>, <span style="color: #000000">Application</span> <span style="color: #000000">$app</span>)
    {
        <span style="color: #000000">$email</span> <span style="color: #000000">=</span> <span style="color: #000000">$request-&gt;</span><span style="color: #836C28">get</span>(<span style="color: #C41A16">&#39;email&#39;</span>);
        <span style="color: #000000">$password</span> <span style="color: #000000">=</span> <span style="color: #000000">$request-&gt;</span><span style="color: #836C28">get</span>(<span style="color: #C41A16">&#39;password&#39;</span>);

        <span style="color: #177500">// validation logic.</span>
        <span style="color: #177500">// ...</span>

        <span style="color: #177500">// Persist the user in your database.</span>
        <span style="color: #000000">$this-&gt;</span><span style="color: #836C28">registrationService</span><span style="color: #000000">-&gt;</span><span style="color: #836C28">register</span>(<span style="color: #000000">$email</span>, <span style="color: #000000">$password</span>);

        <span style="color: #000000">$credentials</span> <span style="color: #000000">=</span> [
            <span style="color: #C41A16">&#39;_csrf_token&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #C41A16">&#39;generate-a-csrf-token&#39;</span>,
            <span style="color: #C41A16">&#39;_username&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #000000">$email</span>,
            <span style="color: #C41A16">&#39;_password&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #000000">$password</span>,
        ];

        <span style="color: #177500">// Create a uri to the login authentication route.</span>
        <span style="color: #000000">$uri</span> <span style="color: #000000">=</span> <span style="color: #000000">$request-&gt;</span><span style="color: #836C28">getUriForPath</span>(<span style="color: #C41A16">&#39;/login/check&#39;</span>);

        <span style="color: #177500">// Create a sub request which pretends to be a user login request.</span>
        <span style="color: #000000">$loginRequest</span> <span style="color: #000000">=</span> <span style="color: #000000">Request::</span><span style="color: #836C28">create</span>(
            <span style="color: #000000">$uri</span>,
            <span style="color: #C41A16">&#39;POST&#39;</span>,
            <span style="color: #000000">$credentials</span>,
            <span style="color: #000000">$request-&gt;</span><span style="color: #836C28">cookies</span><span style="color: #000000">-&gt;</span><span style="color: #836C28">all</span>(),
            <span style="color: #000000">$request-&gt;</span><span style="color: #836C28">files</span><span style="color: #000000">-&gt;</span><span style="color: #836C28">all</span>(),
            <span style="color: #000000">$request-&gt;</span><span style="color: #836C28">server</span><span style="color: #000000">-&gt;</span><span style="color: #836C28">all</span>()
        );

        <span style="color: #177500">// Let our application handle the login request.</span>
        <span style="color: #A90D91">return</span> <span style="color: #000000">$app-&gt;</span><span style="color: #836C28">handle</span>(<span style="color: #000000">$loginRequest</span>);
    }
}
</pre></div>

<p>The configuration for the security provider:</p>
<div class="highlight" style="background: #ffffff"><pre style="line-height: 125%"><span></span><span style="color: #633820">&lt;?php</span>

<span style="color: #000000">$app-&gt;</span><span style="color: #836C28">register</span>(<span style="color: #A90D91">new</span> <span style="color: #000000">SecurityServiceProvider</span>(), <span style="color: #A90D91">array</span>(
    <span style="color: #C41A16">&#39;security.firewalls&#39;</span> <span style="color: #000000">=&gt;</span> [
        <span style="color: #C41A16">&#39;login&#39;</span> <span style="color: #000000">=&gt;</span> [
            <span style="color: #C41A16">&#39;pattern&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #C41A16">&#39;^/login$&#39;</span>,
        ],
        <span style="color: #C41A16">&#39;register&#39;</span> <span style="color: #000000">=&gt;</span> [
            <span style="color: #C41A16">&#39;pattern&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #C41A16">&#39;^/register$&#39;</span>,
        ],
        <span style="color: #C41A16">&#39;app&#39;</span> <span style="color: #000000">=&gt;</span> [
            <span style="color: #C41A16">&#39;pattern&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #C41A16">&#39;^/&#39;</span>,
            <span style="color: #C41A16">&#39;form&#39;</span> <span style="color: #000000">=&gt;</span> [
                <span style="color: #C41A16">&#39;login_path&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #C41A16">&#39;/login&#39;</span>,
                <span style="color: #C41A16">&#39;check_path&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #C41A16">&#39;/login/check&#39;</span>,
            ],
            <span style="color: #C41A16">&#39;logout&#39;</span> <span style="color: #000000">=&gt;</span> [
                <span style="color: #C41A16">&#39;logout_path&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #C41A16">&#39;/logout&#39;</span>,
                <span style="color: #C41A16">&#39;invalidate_session&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #A90D91">true</span>,
            ],
            <span style="color: #C41A16">&#39;users&#39;</span> <span style="color: #000000">=&gt;</span> <span style="color: #000000">$app-&gt;</span><span style="color: #836C28">share</span>(<span style="color: #A90D91">function</span> () <span style="color: #A90D91">use</span> (<span style="color: #000000">$app</span>) {
                <span style="color: #A90D91">return</span> <span style="color: #A90D91">new</span> <span style="color: #000000">UserProvider</span>(<span style="color: #000000">$app</span>[<span style="color: #C41A16">&#39;UserRepository&#39;</span>]);
            }),
        ],
    ],
));
</pre></div>

<p>That&rsquo;s it! Happy coding!</p>

        </div>
        <footer>
            <p style="margin-bottom: 1em;">
                <a class="button is-twitter js-share-button" href="https://twitter.com/intent/tweet?text=Programmatically%20login%20user%20with%20symfony%2fsecurity%20in%20Silex&url=https%3a%2f%2fhansott.github.io%2fpost%2fprogrammatically-login-user-with-symfony-security-in-silex%2f&via=otthans" target="_blank">
                    <span class="icon">
                        <i class="fa fa-twitter"></i>
                    </span>
                    <span>Tweet</span>
                </a>
                <a class="button is-facebook js-share-button" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fhansott.github.io%2fpost%2fprogrammatically-login-user-with-symfony-security-in-silex%2f" target="_blank">
                    <span class="icon">
                        <i class="fa fa-facebook"></i>
                    </span>
                    <span>Share</span>
                </a>
            </p>
        </footer>
        <div id="disqus_thread"></div>
<script>
    var disqus_config = function() {
        this.page.url = 'Programmatically login user with symfony\/security in Silex';
        this.page.title = 'Programmatically login user with symfony\/security in Silex';
        this.page.identifier = 'https:\/\/hansott.github.io\/post\/programmatically-login-user-with-symfony-security-in-silex\/';
    };
    (function() {
        var d = document, s = d.createElement('script');
        s.src = '//hansott.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

        <p class="subtitle" style="margin-top: 2em;">Read More</p>
        <ul>
    
    
    
        <li>
            <p style="margin-bottom: 1em;">
                <a href="/post/a-simple-declarative-and-composable-way-to-fetch-data-for-react-components/">A simple, declarative, and composable way to fetch data for React components</a>
            </p>
        </li>
    
        <li>
            <p style="margin-bottom: 1em;">
                <a href="/post/add-homestead-mysql-as-data-source-in-phpstorm/">Add homestead MySQL as data source in PHPStorm</a>
            </p>
        </li>
    
</ul>

    </article>

            </div>
        </div>
        <footer class="footer">
    <div class="container">
        <div class="content has-text-centered">
            <p>
                Â© Copyright 2017 Hans Ott
            </p>
        </div>
    </div>
</footer>

        <script src="/js/main.js"></script>
        
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-42118181-2', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

    </body>
</html>
